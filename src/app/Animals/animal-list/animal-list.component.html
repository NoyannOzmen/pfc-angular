<main class="h-full pt-12">
  <!-- Menu de recherche -->
  <div class="md:my-3 flex flex-wrap font-body w-[80%] mx-auto bg-zoning rounded-lg shadow justify-around">
    <form class="text-texte justify-around pb-4">
      <div id="fullSearch" class="mx-2 col-span-3 items-center flex flex-wrap justify-around" [class.hidden]="!isHidden">
        <h2 class="font-grands text-3xl w-full my-6 pb-4 text-center">Rechercher un animal</h2>
        <label for="espece-dropdown-small">Par espèce</label>
        <select tabindex="0" class="col-span-3 text-xs block w-[50%] bg-fond" id="espece-dropdown-small" name="especeDropdownSmall" formControlName="especeDropdownSmall" defaultValue="defaultSmall" #filterEspeceSmall>
          <option value="">--Choisissez une espèce--</option>
          @for(espece of speciesList; track $index) {
            <option value="{{ espece.nom }}">{{ espece.nom }}</option>
          }
        </select>
          <input tabindex="0" id="deploy" class="w-[20%] col-span-1 my-1 py-2 px-2 bg-accents2-dark text-fond transition ease-in duration-200 text-center text-xs font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg" type="button" value="Filtres" (click)="toggleFilters()"/>
          <input tabindex="0" class="w-1/3 col-span-1 mx-auto my-3 py-2 px-2 bg-accents1-light text-fond transition ease-in duration-200 text-center text-xs font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg" type="button" value="Rechercher" (click)="filterResultsSmall(filterEspeceSmall.value)" />
      </div>
      <div id="searchCriterias" class="grid grid-cols-3 gap-8 mx-auto my-3 text-texte" [class.hidden]="isHidden">
        <h3 class="col-span-3 font-grands text-3xl text-center my-2">Rechercher un animal</h3>

        <div class="col-span-1 mx-auto">
          <h4>Caractéristiques</h4>

          <!-- Choix de l'espèce -->
          <div class="my-2">
            <label for="espece-dropdown-full">Espèce</label>
            <select tabindex="0" class="text-xs block bg-fond w-3/4" id="espece-dropdown-full" name="especeDropdownFull" formControlName="especeDropdownFull" defaultValue="defaultFull" #filterEspeceFull>
              <option value="">--Choisissez une espèce--</option>
              @for(espece of speciesList; track $index) {
                <option value="{{ espece.nom }}">{{ espece.nom }}</option>
              }
            </select>
          </div>

          <!-- Sexe -->
          <div class="my-2">
              <label for="sexe">Sexe</label>
              <select tabindex="0" class="text-xs block bg-fond w-3/4" id="sexe" name="sexe" formControlName="sexe" defaultValue="defaultSmall" #filterSex>
                <option value="">--Choisissez--</option>
                <option value="Mâle">Mâle</option>
                <option value="Femelle">Femelle</option>
                <option value="Inconnu">Inconnu</option>
              </select>
          </div>

          <!-- Selection Age -->
          <div class="my-2">
            <p>Age :</p>
            <label for="age-min">De&nbsp;</label>
            <input class="bg-fond" id="age-min" name="minAge" formControlName="minAge" type="number" tabindex="0" min="0" max="3999" #filterAgeMin />
            <label for="age-max">&nbsp;à&nbsp;</label>
            <input class="bg-fond" id="age-max" name="maxAge" formControlName="maxAge" type="number" tabindex="0" min="1" max="4000" #filterAgeMax />
            <label>&nbsp;ans.</label>
          </div>
        </div>

        <!-- Sélection Tags -->
        <div class="col-span-1">
          <p>Exclure si :</p>
          @for(tag of tagList; track $index) {
            <div>
              <label for={{tag.nom}}>{{ tag.nom }}</label>
              <input (click)="addtoTagList($event, `${tag.id}`)" type="checkbox" name="tag" formControlName="tag" id={{tag.nom}} value={{tag.nom}} #filterTags />
            </div>
          }
        </div>

        <div class="col-span-1">
          <div class="my-2">
            <label for="dpt-select">Département</label>
            <select tabindex="0" class="text-xs block bg-fond" id="dpt-select" name="dptSelect" #filterDpt>
              <app-dpt-select></app-dpt-select>
            </select>
          </div>
        </div>

        <input tabindex="0"
        class="col-span-3 w-[60%] mx-auto my-3 py-2 px-4 bg-accents1-light text-fond transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg"
        type="button" (click)="filterResultsFull(filterEspeceFull.value, filterSex.value, filterAgeMin.valueAsNumber, filterAgeMax.valueAsNumber, filterDpt.value)"
        value="Rechercher" />
      </div>
    </form>
  </div>

  @if(filteredAnimalList.length > 0) {
    <div class="grid grid-flow-row-dense grid-cols-3 gap-3 m-3 my-8">
      @for(animal of filteredAnimalList; track $index) {
        <app-animal-card [animal]="animal"></app-animal-card>
      }
    </div>
  } @else {
    <h3 class="font-grands text-2xl w-full my-2 text-center">Aucun animal ne correspond à votre recherche</h3>
  }
</main>
